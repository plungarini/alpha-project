(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"+Yqk":function(t,e,i){"use strict";i.r(e),i.d(e,"PaymentModule",function(){return A});var r=i("ofXK"),n=i("PCNd"),o=i("tyNb"),a=i("fXoL"),s=i("mrSG"),b=i("AytR"),l="https://js.stripe.com/v3",c=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,d=null,u=function(t,e,i){if(null===t)return null;var r=t.apply(void 0,e);return function(t,e){t&&t._registerWrapper&&t._registerWrapper({name:"stripe-js",version:"1.13.1",startTime:e})}(r,i),r},p=Promise.resolve().then(function(){return null,null!==d?d:d=new Promise(function(t,e){if("undefined"!=typeof window)if(window,window.Stripe)t(window.Stripe);else try{var i=function(){for(var t=document.querySelectorAll('script[src^="'.concat(l,'"]')),e=0;e<t.length;e++){var i=t[e];if(c.test(i.src))return i}return null}();i||(i=function(t){var e=document.createElement("script");e.src="".concat(l).concat("");var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(e),e}()),i.addEventListener("load",function(){window.Stripe?t(window.Stripe):e(new Error("Stripe.js not available"))}),i.addEventListener("error",function(){e(new Error("Failed to load Stripe.js"))})}catch(r){return void e(r)}else t(null)})}),m=!1;p.catch(function(t){m||console.warn(t)});var h=i("Jgta"),g=i("I/3d"),f=i("TVmF");let S=(()=>{class t{constructor(t,e){this.db=t,this.usersService=e,this.testMode=!1,this.generalError="Si \xe8 verificato un errore. Contatta l'assistenza se il problema persiste.",this.stripeApiTest=b.a.stripe.test,this.stripeApiPublic=b.a.stripe.prod,this.monthlyPriceTest=b.a.stripeProducts.test.month,this.yearlyPriceTest=b.a.stripeProducts.test.year,this.monhtlyPrice=b.a.stripeProducts.prod.month,this.yearlyPrice=b.a.stripeProducts.prod.year}buySubscription(t,e){return Object(s.a)(this,void 0,void 0,function*(){return new Promise((i,r)=>Object(s.a)(this,void 0,void 0,function*(){var n;const o=null===(n=yield this.usersService.getCurrentFire())||void 0===n?void 0:n.uid;if(!o)return r(this.generalError);let a;a=this.testMode?t?this.monthlyPriceTest:this.yearlyPriceTest:t?this.monhtlyPrice:this.yearlyPrice;const b=yield this.db.collection("users").doc(o).collection("checkout_sessions").add({price:a,allow_promotion_codes:!0,success_url:window.location.origin+e||"/dashboard",cancel_url:window.location.href,updatedAt:h.a.firestore.FieldValue.serverTimestamp()});return i(new Promise((t,e)=>{b.onSnapshot(i=>Object(s.a)(this,void 0,void 0,function*(){if(!i||!i.data())return e(this.generalError);const{error:r,sessionId:n}=i.data();if(r)return e(r.message+" Contatta il supporto se il problema persiste.");if(n){const i=yield this.getStripe();return i?(yield i.redirectToCheckout({sessionId:n}),t()):e(this.generalError)}}))}))}))})}getStripe(){return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];m=!0;var r=Date.now();return p.then(function(t){return u(t,e,r)})}(this.testMode?this.stripeApiTest:this.stripeApiPublic)}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(g.a),a.Wb(f.a))},t.\u0275prov=a.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var v=i("lyTB"),y=i("n45d");function x(t,e){if(1&t&&(a.Sb(0,"div",51),a.Sb(1,"p",52),a.Ec(2," Errore "),a.Rb(),a.Sb(3,"p"),a.Ec(4),a.Rb(),a.Rb()),2&t){const t=a.dc();a.Ab(4),a.Gc(" ",t.errorMsg," ")}}const R=function(t,e){return{"opacity-0 -mr-5":t,"opacity-100 -ml-1 mr-2":e}},w=function(t,e){return{"opacity-0 -mr-6":t,"opacity-100 mr-0":e}},E=function(t,e){return{"opacity-0":t,"opacity-100":e}},B=function(t,e){return{"opacity-0 -ml-4":t,"opacity-100 ml-1 -mr-2":e}},M=[{path:"",component:(()=>{class t{constructor(t,e,i,r,n){this.payService=t,this.auth=e,this.userService=i,this.route=r,this.router=n,this.disableBtn=!1,this.loadingBtnMonth=!1,this.loadingBtnYear=!1,this.errorMsg=""}ngOnInit(){this.userService.userSubscriptionStatus().then(t=>{"active"!==t&&"trialing"!==t||this.router.navigateByUrl("/dashboard")}),this.returnUrl=this.route.snapshot.queryParamMap.get("subReturnUrl")||void 0,this.firstSub=!("false"===this.route.snapshot.queryParamMap.get("firstSub"))}buyMonthly(){this.disableBtn=!0,this.loadingBtnMonth=!0,this.payService.buySubscription(!0,this.returnUrl).then(t=>{this.loadingBtnMonth=!1,this.disableBtn=!1,console.log(t)}).catch(t=>{this.loadingBtnMonth=!1,this.disableBtn=!1,this.errorMsg=t,setTimeout(()=>{this.errorMsg=""},7e3)}).finally(()=>{this.loadingBtnMonth=!1,this.disableBtn=!1})}buyYearly(){this.disableBtn=!0,this.loadingBtnYear=!0,this.payService.buySubscription(!1).then(t=>{this.loadingBtnYear=!1,this.disableBtn=!1,console.log(t)}).catch(t=>{this.loadingBtnYear=!1,this.disableBtn=!1,this.errorMsg=t,setTimeout(()=>{this.errorMsg=""},7e3)}).finally(()=>{this.loadingBtnYear=!1,this.disableBtn=!1})}logout(){this.auth.signOut()}}return t.\u0275fac=function(e){return new(e||t)(a.Mb(S),a.Mb(v.a),a.Mb(f.a),a.Mb(o.a),a.Mb(o.g))},t.\u0275cmp=a.Gb({type:t,selectors:[["app-payment"]],decls:153,vars:37,consts:[["class","fixed top-4 right-4 w-full max-w-sm rounded bg-red-200 border-red-600 text-red-600 border-l-4 p-4","role","alert",4,"ngIf"],[1,"bg-black-900"],[1,"max-w-7xl","mx-auto","pt-16","pb-0","px-4","sm:py-24","sm:px-6","lg:px-8"],[1,"pb-16"],[1,"text-gray-100","text-4xl","text-center","font-extrabold","sm:text-5xl","sm:tracking-tight"],[1,"mt-5","text-xl","text-gray-500","text-center"],[1,"flex","flex-col","md:flex-row","items-center","md:items-baseline","justify-evenly","sm:mx-10","mb-16"],[1,"w-full","mx-2","mb-6","relative","overflow-hidden","bg-yellow-500","rounded-lg","max-w-sm","shadow-lg"],["viewBox","0 0 375 283","fill","none",1,"absolute","-bottom-4","left-0","mb-8"],["x","159.52","y","175","width","152","height","152","rx","8","transform","rotate(-45 159.52 175)","fill","#f3c06b"],["y","107.48","width","152","height","152","rx","8","transform","rotate(-45 0 107.48)","fill","#f3c06b"],[1,"relative","text-white","px-6","pb-4","mt-6"],[1,"flex","justify-between"],[1,"block","font-semibold","text-xl"],[1,"bg-white","rounded-full","text-yellow-500","text-xs","font-bold","px-3","py-2","leading-none","flex","items-center"],["type","button",1,"focus:outline-none","relative","inline-flex","items-center","mx-6","mb-5","px-4","py-1","text-sm","leading-6","font-medium","rounded-md","border","border-transparent","text-white","bg-gray-800","hover:bg-gray-700","focus:border-rose-700","active:bg-rose-700","transition","ease-in-out","duration-150","cursor-pointer","disabled:cursor-not-allowed",3,"disabled","click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","opacity-0","-mr-5","transition-all","duration-300","ease-in-out","h-4","w-4","text-white",3,"ngClass"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"opacity-100","mr-0","transition-all","duration-300",3,"ngClass"],[1,"absolute","left-9","opacity-0","transition-all","duration-300",3,"ngClass"],["name","arrowRightShort","width","1rem","height","1rem",1,"transition-all","duration-300","ease-in-out","opacity-0","-ml-4",3,"ngClass"],[1,"w-full","mx-2","mt-6","mb:mt-0","mb-6","relative","bg-blue-500","rounded-lg","max-w-sm","shadow-lg"],[1,"bg-green-500","rounded-full","text-white","text-xs","font-bold","px-3","py-2","shadow-lg","absolute","-top-4","left-4","z-10"],[1,"relative","overflow-hidden"],["viewBox","0 0 375 283","fill","none",1,"absolute","-bottom-12","left-0","mb-8"],["x","159.52","y","175","width","152","height","152","rx","8","transform","rotate(-45 159.52 175)","fill","#6da3fb"],["y","107.48","width","152","height","152","rx","8","transform","rotate(-45 0 107.48)","fill","#6da3fb"],[1,"bg-white","rounded-full","text-blue-500","text-xs","font-bold","px-3","py-2","leading-none","flex","items-center"],[1,"block","mx-auto","w-max","mb-12","text-center",3,"click"],[1,"underline","cursor-pointer"],[1,"border-t","border-gray-700","pt-16","xl:grid","xl:grid-cols-3","xl:gap-x-8"],[1,"text-base","font-semibold","text-blue-600","uppercase","tracking-wide"],[1,"mt-2","text-3xl","font-extrabold","text-gray-200"],[1,"mt-4","text-lg","text-gray-500"],[1,"mt-4","sm:mt-8","md:mt-10","md:grid","md:grid-cols-2","md:gap-x-8","xl:mt-0","xl:col-span-2"],[1,"divide-y","divide-gray-200"],[1,"py-4","flex","md:py-0","md:pb-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","aria-hidden","true",1,"flex-shrink-0","h-6","w-6","text-green-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"ml-3","text-base","text-gray-500"],[1,"py-4","flex"],[1,"border-t","border-gray-200","divide-y","divide-gray-200","md:border-t-0"],[1,"py-4","flex","md:border-t-0","md:py-0","md:pb-4"],[1,"bg-blue-900"],[1,"max-w-7xl","mx-auto","py-16","px-4","sm:py-24","sm:px-6","lg:px-8"],[1,"text-3xl","font-extrabold","text-white"],[1,"mt-6","border-t","border-blue-400","border-opacity-25","pt-10"],[1,"space-y-10","md:space-y-0","md:grid","md:grid-cols-2","md:grid-rows-2","md:gap-x-8","md:gap-y-12"],[1,"text-lg","leading-6","font-medium","text-white"],[1,"mt-2","text-base","text-blue-200"],["role","alert",1,"fixed","top-4","right-4","w-full","max-w-sm","rounded","bg-red-200","border-red-600","text-red-600","border-l-4","p-4"],[1,"font-bold"]],template:function(t,e){1&t&&(a.Cc(0,x,5,1,"div",0),a.Sb(1,"div",1),a.Sb(2,"div",2),a.Sb(3,"div",3),a.Sb(4,"h1",4),a.Ec(5),a.Rb(),a.Sb(6,"p",5),a.Ec(7),a.Rb(),a.Rb(),a.Sb(8,"div",6),a.Sb(9,"div",7),a.cc(),a.Sb(10,"svg",8),a.Nb(11,"rect",9),a.Nb(12,"rect",10),a.Rb(),a.bc(),a.Sb(13,"div",11),a.Sb(14,"div",12),a.Sb(15,"span",13),a.Ec(16," Starter "),a.Rb(),a.Sb(17,"span",14),a.Ec(18," \u20ac19 al mese "),a.Rb(),a.Rb(),a.Rb(),a.Sb(19,"button",15),a.Zb("click",function(){return e.buyMonthly()}),a.cc(),a.Sb(20,"svg",16),a.Nb(21,"circle",17),a.Nb(22,"path",18),a.Rb(),a.bc(),a.Sb(23,"span",19),a.Ec(24,"Acquista ora"),a.Rb(),a.Sb(25,"span",20),a.Ec(26,"Attendi..."),a.Rb(),a.Nb(27,"i-bs",21),a.Rb(),a.Rb(),a.Sb(28,"div",22),a.Sb(29,"span",23),a.Ec(30," Risparmi \u20ac48! "),a.Rb(),a.Sb(31,"div",24),a.cc(),a.Sb(32,"svg",25),a.Nb(33,"rect",26),a.Nb(34,"rect",27),a.Rb(),a.bc(),a.Sb(35,"div",11),a.Sb(36,"div",12),a.Sb(37,"span",13),a.Ec(38," Il Convinto "),a.Rb(),a.Sb(39,"span",28),a.Ec(40," \u20ac180 all'anno "),a.Rb(),a.Rb(),a.Rb(),a.Sb(41,"button",15),a.Zb("click",function(){return e.buyYearly()}),a.cc(),a.Sb(42,"svg",16),a.Nb(43,"circle",17),a.Nb(44,"path",18),a.Rb(),a.bc(),a.Sb(45,"span",19),a.Ec(46,"Acquista ora"),a.Rb(),a.Sb(47,"span",20),a.Ec(48,"Attendi..."),a.Rb(),a.Nb(49,"i-bs",21),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Sb(50,"div",29),a.Zb("click",function(){return e.logout()}),a.Sb(51,"b"),a.Ec(52,"Sei gi\xe0 abbonato?"),a.Rb(),a.Nb(53,"br"),a.Sb(54,"span",30),a.Ec(55,"accedi con un'altro account"),a.Rb(),a.Rb(),a.Sb(56,"div",31),a.Sb(57,"div"),a.Sb(58,"h2",32),a.Ec(59,"Everything you need"),a.Rb(),a.Sb(60,"p",33),a.Ec(61,"All-in-one platform"),a.Rb(),a.Sb(62,"p",34),a.Ec(63,"Ac euismod vel sit maecenas id pellentesque eu sed consectetur. Malesuada adipiscing sagittis vel nulla nec. Urna, sed a lectus elementum blandit et."),a.Rb(),a.Rb(),a.Sb(64,"div",35),a.Sb(65,"ul",36),a.Sb(66,"li",37),a.cc(),a.Sb(67,"svg",38),a.Nb(68,"path",39),a.Rb(),a.bc(),a.Sb(69,"span",40),a.Ec(70,"Vitae in pulvinar odio id utobortis in inter."),a.Rb(),a.Rb(),a.Sb(71,"li",41),a.cc(),a.Sb(72,"svg",38),a.Nb(73,"path",39),a.Rb(),a.bc(),a.Sb(74,"span",40),a.Ec(75,"Sed sed id viverra viverra augue eget massa."),a.Rb(),a.Rb(),a.Sb(76,"li",41),a.cc(),a.Sb(77,"svg",38),a.Nb(78,"path",39),a.Rb(),a.bc(),a.Sb(79,"span",40),a.Ec(80,"Urna, gravida amet, a, integer venenatis."),a.Rb(),a.Rb(),a.Sb(81,"li",41),a.cc(),a.Sb(82,"svg",38),a.Nb(83,"path",39),a.Rb(),a.bc(),a.Sb(84,"span",40),a.Ec(85,"Lobortis sed pharetra amet vitae eleifend."),a.Rb(),a.Rb(),a.Sb(86,"li",41),a.cc(),a.Sb(87,"svg",38),a.Nb(88,"path",39),a.Rb(),a.bc(),a.Sb(89,"span",40),a.Ec(90,"Ullamcorper blandit a consequat donec elit aoreet."),a.Rb(),a.Rb(),a.Rb(),a.Sb(91,"ul",42),a.Sb(92,"li",43),a.cc(),a.Sb(93,"svg",38),a.Nb(94,"path",39),a.Rb(),a.bc(),a.Sb(95,"span",40),a.Ec(96,"Vitae in pulvinar odio id utobortis in inter."),a.Rb(),a.Rb(),a.Sb(97,"li",41),a.cc(),a.Sb(98,"svg",38),a.Nb(99,"path",39),a.Rb(),a.bc(),a.Sb(100,"span",40),a.Ec(101,"Sed sed id viverra viverra augue eget massa."),a.Rb(),a.Rb(),a.Sb(102,"li",41),a.cc(),a.Sb(103,"svg",38),a.Nb(104,"path",39),a.Rb(),a.bc(),a.Sb(105,"span",40),a.Ec(106,"Urna, gravida amet, a, integer venenatis."),a.Rb(),a.Rb(),a.Sb(107,"li",41),a.cc(),a.Sb(108,"svg",38),a.Nb(109,"path",39),a.Rb(),a.bc(),a.Sb(110,"span",40),a.Ec(111,"Lobortis sed pharetra amet vitae eleifend."),a.Rb(),a.Rb(),a.Sb(112,"li",41),a.cc(),a.Sb(113,"svg",38),a.Nb(114,"path",39),a.Rb(),a.bc(),a.Sb(115,"span",40),a.Ec(116,"Ullamcorper blandit a consequat donec elit aoreet."),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Sb(117,"div",44),a.Sb(118,"div",45),a.Sb(119,"h2",46),a.Ec(120," Frequently asked questions "),a.Rb(),a.Sb(121,"div",47),a.Sb(122,"dl",48),a.Sb(123,"div"),a.Sb(124,"dt",49),a.Ec(125," What's the best thing about Switzerland? "),a.Rb(),a.Sb(126,"dd",50),a.Ec(127," I don't know, but the flag is a big plus. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Sb(128,"div"),a.Sb(129,"dt",49),a.Ec(130," Why do you never see elephants hiding in trees? "),a.Rb(),a.Sb(131,"dd",50),a.Ec(132," Because they're so good at it. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Sb(133,"div"),a.Sb(134,"dt",49),a.Ec(135," How do you make holy water? "),a.Rb(),a.Sb(136,"dd",50),a.Ec(137," You boil the hell out of it. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Sb(138,"div"),a.Sb(139,"dt",49),a.Ec(140," Why can't you hear a pterodactyl go to the bathroom? "),a.Rb(),a.Sb(141,"dd",50),a.Ec(142," Because the pee is silent. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Sb(143,"div"),a.Sb(144,"dt",49),a.Ec(145," What do you call someone with no body and no nose? "),a.Rb(),a.Sb(146,"dd",50),a.Ec(147," Nobody knows. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Sb(148,"div"),a.Sb(149,"dt",49),a.Ec(150," Why did the invisible man turn down the job offer? "),a.Rb(),a.Sb(151,"dd",50),a.Ec(152," He couldn't see himself doing it. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas cupiditate laboriosam fugiat. "),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb()),2&t&&(a.jc("ngIf",e.errorMsg),a.Ab(5),a.Gc(" ",e.firstSub?"Un unico prezzo":"Abbonamento scaduto"," "),a.Ab(2),a.Gc(" ",e.firstSub?"Prima di continuare, decidi solo se pagare mensilmente o annualmente.":"Hai cancellato il tuo abbonamento. Creane uno nuovo per procedere."," "),a.Ab(12),a.jc("disabled",e.disableBtn),a.Ab(1),a.jc("ngClass",a.mc(13,R,!e.loadingBtnMonth,e.loadingBtnMonth)),a.Ab(3),a.jc("ngClass",a.mc(16,w,e.loadingBtnMonth,!e.loadingBtnMonth)),a.Ab(2),a.jc("ngClass",a.mc(19,E,!e.loadingBtnMonth,e.loadingBtnMonth)),a.Ab(2),a.jc("ngClass",a.mc(22,B,e.loadingBtnMonth,!e.loadingBtnMonth)),a.Ab(14),a.jc("disabled",e.disableBtn),a.Ab(1),a.jc("ngClass",a.mc(25,R,!e.loadingBtnYear,e.loadingBtnYear)),a.Ab(3),a.jc("ngClass",a.mc(28,w,e.loadingBtnYear,!e.loadingBtnYear)),a.Ab(2),a.jc("ngClass",a.mc(31,E,!e.loadingBtnYear,e.loadingBtnYear)),a.Ab(2),a.jc("ngClass",a.mc(34,B,e.loadingBtnYear,!e.loadingBtnYear)))},directives:[r.m,r.k,y.a],encapsulation:2}),t})()}];let k=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(e){return new(e||t)},imports:[[o.k.forChild(M)],o.k]}),t})(),A=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(e){return new(e||t)},imports:[[r.c,k,n.a]]}),t})()}}]);