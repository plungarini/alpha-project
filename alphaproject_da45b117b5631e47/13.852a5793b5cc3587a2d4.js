(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{ulD6:function(e,t,s){"use strict";s.r(t),s.d(t,"AdminUsersModule",function(){return F});var i=s("ofXK"),n=s("3Pt+"),r=s("PCNd"),a=s("tyNb"),c=s("XNiG"),l=s("1G5W"),o=s("fXoL"),d=s("TVmF");function b(e,t){1&e&&(o.Sb(0,"div",25),o.Nb(1,"i-bs",26),o.Ec(2," Admin "),o.Rb())}function u(e,t){if(1&e&&(o.Sb(0,"div",27),o.Ec(1),o.Rb()),2&e){const e=o.dc().$implicit;o.Ab(1),o.Gc(" ",e.name?e.email:"Utente"," ")}}const p=function(e,t){return{"bg-black-800 hover:bg-black-700 hover:shadow-xl":e,"bg-gray-700":t}};function m(e,t){if(1&e){const e=o.Tb();o.Qb(0),o.Sb(1,"li",14),o.Sb(2,"div",15),o.Zb("click",function(){o.vc(e);const s=t.$implicit;return o.dc().selectUser(s.id)}),o.Sb(3,"div",16),o.Nb(4,"app-avatar",17),o.Rb(),o.Sb(5,"div",18),o.Sb(6,"div",19),o.Ec(7),o.Rb(),o.Cc(8,b,3,0,"div",20),o.Cc(9,u,2,1,"div",21),o.Rb(),o.Sb(10,"button",22),o.cc(),o.Sb(11,"svg",23),o.Nb(12,"path",24),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Pb()}if(2&e){const e=t.$implicit,s=o.dc();o.Ab(2),o.jc("ngClass",o.mc(6,p,!e.selected,e.selected)),o.Ab(2),o.jc("user",s.getAvatarInfo(e))("enableProfileLink",!1),o.Ab(3),o.Gc(" ",e.name||e.email," "),o.Ab(1),o.jc("ngIf",e.roles.admin),o.Ab(1),o.jc("ngIf",e.roles.subscriber&&!e.roles.admin)}}let f=(()=>{class e{constructor(e,t){this.userService=e,this.cdRef=t,this.pageTitle="Tutti gli utenti",this.users=[],this.searchInput=new n.e,this.destroyed$=new c.a}ngOnInit(){this.userService.getAll().pipe(Object(l.a)(this.destroyed$)).subscribe(e=>{if(!e)return;this.users=e.map((e,t)=>Object.assign(Object.assign({},e),{selected:0===t})),this.filteredUsers||(this.filteredUsers=this.users);const t=this.users.filter(e=>e.selected)[0];this.selectUser(t.id),this.cdRef.detectChanges()}),this.searchInput.valueChanges.pipe(Object(l.a)(this.destroyed$)).subscribe(e=>{this.filteredUsers=e?this.filterUsers(e):this.users})}ngOnDestroy(){this.destroyed$.next(!0)}selectUser(e){e&&this.users.map(t=>(t.selected=t.id===e,t.selected&&(this.selectedUser=t),t))}getAvatarInfo(e){var t,s;return{img:(null===(t=e.details)||void 0===t?void 0:t.imgUrl)||"",fullName:e.name||"",email:e.email,color:(null===(s=e.details)||void 0===s?void 0:s.imgColorBg)||"indigo"}}filterUsers(e){const t=e.toLowerCase();return this.users.filter(e=>{const s=e.name.toLowerCase(),i=e.email.toLowerCase(),n=e.roles.admin?"admin":e.roles.editor?"editor":"";return s.includes(t)||i.includes(t)||n.includes(t)})}}return e.\u0275fac=function(t){return new(t||e)(o.Mb(d.a),o.Mb(o.h))},e.\u0275cmp=o.Gb({type:e,selectors:[["app-admin-users"]],decls:18,vars:4,consts:[[1,"flex","flex-col","sm:flex-row","space-y-6","sm:space-y-0","sm:space-x-6"],[1,"w-full","sm:max-w-sm"],["for","searchUser",1,"block","text-sm","font-medium"],[1,"mt-1","flex","rounded-md","shadow-sm"],[1,"relative","flex","items-stretch","flex-grow","focus-within:z-10"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["name","peopleFill","width","1.2rem","height","1.2rem"],["type","text","name","searchUser","id","searchUser","autocomplete","new-password",1,"focus:ring-indigo-500","focus:border-indigo-500","block","w-full","rounded-none","rounded-l-md","pl-10","sm:text-sm","border-gray-500","text-gray-300","bg-black-800",3,"formControl","placeholder"],[1,"-ml-px","relative","inline-flex","items-center","space-x-2","px-4","py-2","border","border-gray-500","text-sm","font-medium","rounded-r-md","text-gray-300","bg-black-700","hover:bg-black-600","focus:outline-none","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500"],["name","funnelFill","width","1.2rem","height","1.2rem"],[1,"user-container"],[1,"flex","flex-col","w-full","max-w-full"],[4,"ngFor","ngForOf"],[1,"hidden","sm:block",3,"user"],[1,"border-gray-400","flex","flex-row","mb-2","justify-start","w-full","max-w-full"],[1,"transition","duration-500","shadow","ease-in-out","select-none","cursor-pointer","rounded-md","flex","flex-1","items-center","p-4","w-full",2,"min-height","80px",3,"ngClass","click"],[1,"flex","flex-col","w-10","h-10","items-center","mr-4"],["displayType","img",3,"user","enableProfileLink"],[1,"flex-1","pl-1","md:mr-16"],[1,"font-medium","dark:text-white"],["class","text-sm text-yellow-400 inline-flex items-center",4,"ngIf"],["class","text-sm",4,"ngIf"],[1,"w-max","text-right","flex","justify-end"],["width","12","fill","currentColor","height","12","viewBox","0 0 1792 1792","xmlns","http://www.w3.org/2000/svg",1,"hover:text-gray-800","dark:hover:text-white","dark:text-gray-200","text-gray-500"],["d","M1363 877l-742 742q-19 19-45 19t-45-19l-166-166q-19-19-19-45t19-45l531-531-531-531q-19-19-19-45t19-45l166-166q19-19 45-19t45 19l742 742q19 19 19 45t-19 45z"],[1,"text-sm","text-yellow-400","inline-flex","items-center"],["name","shieldFillCheck","width",".8rem","height",".8rem",1,"mr-1"],[1,"text-sm"]],template:function(e,t){1&e&&(o.Sb(0,"div",0),o.Sb(1,"div",1),o.Sb(2,"div",1),o.Sb(3,"label",2),o.Ec(4,"Cerca un utente"),o.Rb(),o.Sb(5,"div",3),o.Sb(6,"div",4),o.Sb(7,"div",5),o.Nb(8,"i-bs",6),o.Rb(),o.Nb(9,"input",7),o.Rb(),o.Sb(10,"button",8),o.Nb(11,"i-bs",9),o.Sb(12,"span"),o.Ec(13,"Filtra"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Sb(14,"div",10),o.Sb(15,"ul",11),o.Cc(16,m,13,9,"ng-container",12),o.Rb(),o.Rb(),o.Rb(),o.Nb(17,"app-admin-user-details",13),o.Rb()),2&e&&(o.Ab(9),o.jc("formControl",t.searchInput)("placeholder","Cerca fra "+(t.users?t.users.length:0)+" utenti"),o.Ab(7),o.jc("ngForOf",t.filteredUsers),o.Ab(1),o.jc("user",t.selectedUser))},styles:["[_nghost-%COMP%]{display:block}@media (min-width:768px){.user-container[_ngcontent-%COMP%]{max-height:69vh}}@media (min-width:640px){.user-container[_ngcontent-%COMP%]{max-width:640px}}@media (min-width:768px){.user-container[_ngcontent-%COMP%]{max-width:768px}}@media (min-width:1024px){.user-container[_ngcontent-%COMP%]{max-width:1024px}}@media (min-width:1280px){.user-container[_ngcontent-%COMP%]{max-width:1280px}}@media (min-width:1536px){.user-container[_ngcontent-%COMP%]{max-width:1536px}}.user-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;margin-top:1.25rem;max-width:100%;width:100%}@media (min-width:768px){.user-container[_ngcontent-%COMP%]{overflow-y:auto}}"],changeDetection:0}),e})();const h=[{path:"",component:f}];let g=(()=>{class e{}return e.\u0275mod=o.Kb({type:e}),e.\u0275inj=o.Jb({factory:function(t){return new(t||e)},imports:[[a.k.forChild(h)],a.k]}),e})();var x=s("mrSG"),v=s("Jgta"),w=s("AytR"),y=s("PT0D"),S=s("n45d");function R(e,t){1&e&&o.Nb(0,"span",14)}function A(e,t){if(1&e&&(o.Sb(0,"a",18),o.Ec(1," Info "),o.Nb(2,"i-bs",19),o.Rb()),2&e){const e=o.dc(2).$implicit;o.jc("href",e.link,o.xc)}}function C(e,t){if(1&e&&(o.Sb(0,"div",15),o.Sb(1,"p",16),o.Ec(2),o.Rb(),o.Cc(3,A,3,1,"a",17),o.Rb()),2&e){const e=o.dc().$implicit;o.Eb("space-x-4",e.link),o.Ab(2),o.Gc(" ",e.desc," "),o.Ab(1),o.jc("ngIf",e.link)}}function k(e,t){if(1&e&&(o.Sb(0,"div",20),o.Sb(1,"p",21),o.Ec(2),o.Rb(),o.Sb(3,"p",22),o.Ec(4),o.Rb(),o.Rb()),2&e){const e=o.dc().$implicit;o.Ab(2),o.Gc(" ",e.title," "),o.Ab(2),o.Gc(" ",e.desc," ")}}const I=function(e,t,s,i){return{"bg-red-500":e,"bg-green-500":t,"bg-yellow-500":s,"bg-gray-500":i}};function D(e,t){if(1&e&&(o.Sb(0,"li"),o.Sb(1,"div",3),o.Cc(2,R,1,0,"span",4),o.Sb(3,"div",5),o.Sb(4,"div"),o.Sb(5,"span",6),o.Nb(6,"i-bs",7),o.Rb(),o.Rb(),o.Sb(7,"div",8),o.Sb(8,"div",9),o.Sb(9,"p",10),o.Ec(10),o.Rb(),o.Cc(11,C,4,4,"div",11),o.Cc(12,k,5,2,"div",12),o.Rb(),o.Sb(13,"div",13),o.Sb(14,"time"),o.ec(15,"date"),o.Ec(16),o.ec(17,"date"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()),2&e){const e=t.$implicit,s=t.last,i=o.dc();o.Ab(2),o.jc("ngIf",!s),o.Ab(3),o.jc("ngClass",o.oc(16,I,"error"===e.type,"success"===e.type||"new_user"===e.type,"updated_user"===e.type,"unknown"===e.type)),o.Ab(1),o.jc("name",i.getIconName(e.type)),o.Ab(2),o.Eb("cursor-pointer",e.desc),o.Ab(2),o.Fc(e.title),o.Ab(1),o.jc("ngIf",e.desc),o.Ab(1),o.jc("ngIf",e.desc),o.Ab(2),o.Bb("datetime",o.gc(15,10,e.date,"yyyy-MM-d")),o.Ab(2),o.Fc(o.gc(17,13,e.date,"MMM d"))}}const M=function(e){return{"h-full max-h-96 overflow-y-auto":e}};let E=(()=>{class e{constructor(){}set setUser(e){e&&(this.user=e)}set info(e){e&&this.initFeed(e)}ngOnInit(){}getIconName(e){switch(e){case"error":return"x";case"success":return"check2";case"new_user":return"personPlusFill";case"updated_user":return"personLinesFill";default:return"exclamation"}}initFeed(e){if(!e)return;const t=[];e.sessions.forEach(e=>{if(e.sessionId)return;const s=`Errore durante l'acquisto dell'abbonamento ${this.priceToSubType(e.price)}:\n\n`,i={id:this.makeId(10)+this.makeId(10),type:e.error?"error":"unknown",title:e.error?"Errore durante l'aquisto.":"",desc:e.error?s+e.error.message:"",date:e.updatedAt?new Date(1e3*e.updatedAt.seconds):null,timestamp:e.updatedAt?e.updatedAt.seconds:null};"unknown"!==i.type&&t.push(i)}),this.user&&(t.push({id:this.user.id+"_created",type:"new_user",title:"Iscrizione dell'utente",date:this.user.createdAt?new Date(1e3*this.user.createdAt.seconds):null,timestamp:this.user.createdAt?this.user.createdAt.seconds:null}),t.push({id:this.user.id+"_updated",type:"updated_user",title:"Modifiche all'utente",date:this.user.updatedAt?new Date(1e3*this.user.updatedAt.seconds):null,timestamp:this.user.updatedAt?this.user.updatedAt.seconds:null})),e.subs.forEach(e=>{const s=[];e.canceled_at&&s.push({id:e.id+"_canceled",type:"error",title:"Pagamento ricorrente cancellato",desc:`L'utente ha cancellato l'abbonamento con ID: ${e.id}`,link:e.stripeLink,date:e.canceled_at?new Date(1e3*e.canceled_at.seconds):null,timestamp:e.canceled_at?e.canceled_at.seconds:null}),s.push({id:e.id+"_created",type:"success",title:"Pagamento ricorrente creato",desc:`L'utente si \xe8 iscritto all'abbonamento con ID: ${e.id}`,link:e.stripeLink,date:e.created?new Date(1e3*e.created.seconds):null,timestamp:e.created?e.created.seconds:null}),s.forEach(e=>t.push(e))}),t.sort((e,t)=>t.timestamp-e.timestamp),this.feedItems=t}priceToSubType(e){return e===w.a.stripeProducts.prod.month?"mensile":e===w.a.stripeProducts.prod.year?"annuale":""}makeId(e){let t="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=s.length;for(let n=0;n<e;n++)t+=s.charAt(Math.floor(Math.random()*i));return t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Gb({type:e,selectors:[["app-admin-user-feed"]],inputs:{setUser:["user","setUser"],info:["subsInfo","info"]},decls:3,vars:4,consts:[[1,"relative","flow-root","px-6",3,"ngClass"],[1,"-mb-8"],[4,"ngFor","ngForOf"],[1,"relative","pb-8"],["class","absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-600","aria-hidden","true",4,"ngIf"],[1,"relative","flex","items-center","space-x-3"],[1,"h-8","w-8","rounded-full","text-white","flex","items-center","justify-center","ring-8","ring-black-800",3,"ngClass"],["width","1.25rem","height","1.25rem",3,"name"],[1,"min-w-0","flex-1","flex","justify-between","space-x-4"],[1,"group","max-w-md","flex-1","relative"],[1,"text-sm","clamp-feed-item"],["class","flex flex-row",3,"space-x-4",4,"ngIf"],["class","opacity-0 group-hover:opacity-100 max-w-sm z-10 absolute top-11 left-0 bg-black-900 shadow-lg rounded-md px-4 py-4 pointer-events-none",4,"ngIf"],[1,"text-right","text-sm","whitespace-nowrap"],["aria-hidden","true",1,"absolute","top-4","left-4","-ml-px","h-full","w-0.5","bg-gray-600"],[1,"flex","flex-row"],[1,"text-sm","text-gray-500","w-full","max-w-full","truncate","relative","flex-1"],["target","_blank","class","text-sm w-min text-blue-400 inline-flex item-center justify-center",3,"href",4,"ngIf"],["target","_blank",1,"text-sm","w-min","text-blue-400","inline-flex","item-center","justify-center",3,"href"],["name","arrowRightShort","width","0.95rem","height","0.95rem",1,"mt-0.5"],[1,"opacity-0","group-hover:opacity-100","max-w-sm","z-10","absolute","top-11","left-0","bg-black-900","shadow-lg","rounded-md","px-4","py-4","pointer-events-none"],[1,"text-sm","text-gray-200","pb-2"],[1,"text-sm","text-gray-400","border-t","border-gray-700","pt-2"]],template:function(e,t){1&e&&(o.Sb(0,"div",0),o.Sb(1,"ul",1),o.Cc(2,D,18,21,"li",2),o.Rb(),o.Rb()),2&e&&(o.jc("ngClass",o.lc(2,M,t.feedItems&&t.feedItems.length>=6)),o.Ab(2),o.jc("ngForOf",t.feedItems))},directives:[i.k,i.l,i.m,S.a],pipes:[i.f],styles:["[_nghost-%COMP%]{display:block}.clamp-feed-item[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}"],changeDetection:0}),e})();var j=s("xvIq");function _(e,t){1&e&&(o.Sb(0,"div",26),o.Nb(1,"i-bs",27),o.Rb())}function U(e,t){if(1&e&&(o.Sb(0,"a",28),o.Nb(1,"app-path-svg",29),o.Sb(2,"div",30),o.Sb(3,"p",31),o.Ec(4," Visualizza su Stripe "),o.Rb(),o.Rb(),o.Rb()),2&e){const e=o.dc(2);o.Bb("href",e.user.stripeLink,o.xc)}}function P(e,t){if(1&e&&(o.Sb(0,"div",14),o.Sb(1,"dt",15),o.Ec(2," Abbonamento creato il "),o.Rb(),o.Sb(3,"dd",16),o.Ec(4),o.ec(5,"date"),o.Rb(),o.Rb()),2&e){const e=o.dc(2);o.Ab(4),o.Gc(" ",o.gc(5,1,e.stripeDetails.subStartDate,"d MMMM, yyyy")," ")}}function O(e,t){if(1&e&&(o.Sb(0,"div",14),o.Sb(1,"dt",15),o.Ec(2," Prossimo rinnovo "),o.Rb(),o.Sb(3,"dd",16),o.Ec(4),o.ec(5,"date"),o.Rb(),o.Rb()),2&e){const e=o.dc(2);o.Ab(4),o.Gc(" ",o.gc(5,1,e.stripeDetails.subRecurring,"d MMMM, yyyy")," ")}}function N(e,t){if(1&e&&(o.Sb(0,"div",14),o.Sb(1,"dt",15),o.Ec(2," Cancellato il "),o.Rb(),o.Sb(3,"dd",16),o.Ec(4),o.ec(5,"date"),o.Rb(),o.Rb()),2&e){const e=o.dc(2);o.Ab(4),o.Gc(" ",o.gc(5,1,e.stripeDetails.canceledDate,"d MMMM, yyyy")," ")}}function G(e,t){if(1&e&&(o.Sb(0,"div",1),o.Sb(1,"div",2),o.Sb(2,"div",3),o.Sb(3,"div",4),o.Sb(4,"div",5),o.Nb(5,"app-avatar",6),o.Cc(6,_,2,0,"div",7),o.Sb(7,"div"),o.Sb(8,"div",8),o.Sb(9,"h3",9),o.Ec(10),o.Rb(),o.Rb(),o.Sb(11,"p",10),o.Ec(12),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Cc(13,U,5,1,"a",11),o.Rb(),o.Rb(),o.Sb(14,"div",12),o.Sb(15,"dl",13),o.Sb(16,"div",14),o.Sb(17,"dt",15),o.Ec(18," Data di iscrizione "),o.Rb(),o.Sb(19,"dd",16),o.Sb(20,"time"),o.ec(21,"date"),o.Ec(22),o.ec(23,"date"),o.Rb(),o.Rb(),o.Rb(),o.Sb(24,"div",14),o.Sb(25,"dt",15),o.Ec(26," Importo speso "),o.Rb(),o.Sb(27,"dd",16),o.Ec(28),o.ec(29,"currency"),o.Rb(),o.Rb(),o.Sb(30,"div",14),o.Sb(31,"dt",15),o.Ec(32," Stato dell'abbonamento "),o.Rb(),o.Sb(33,"dd"),o.Ec(34),o.Rb(),o.Rb(),o.Sb(35,"div",14),o.Sb(36,"dt",15),o.Ec(37," Tipo di abbonamento "),o.Rb(),o.Sb(38,"dd",16),o.Ec(39),o.Rb(),o.Rb(),o.Cc(40,P,6,4,"div",17),o.Cc(41,O,6,4,"div",17),o.Cc(42,N,6,4,"div",17),o.Rb(),o.Sb(43,"p",18),o.Ec(44," Azioni recenti "),o.Rb(),o.Nb(45,"app-admin-user-feed",19),o.Sb(46,"div",20),o.Sb(47,"p",21),o.Ec(48,"Azioni rapide"),o.Rb(),o.Sb(49,"div",22),o.Sb(50,"a",23),o.Ec(51," Invia Email "),o.Rb(),o.Sb(52,"button",24),o.Ec(53," Resetta Password "),o.Rb(),o.Sb(54,"button",25),o.Ec(55," Disabilita "),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()),2&e){const e=o.dc();o.Ab(5),o.jc("user",e.getAvatarInfo(e.user))("enableProfileLink",!1),o.Ab(1),o.jc("ngIf",e.user.roles.admin),o.Ab(4),o.Fc(e.user.name||e.user.email),o.Ab(2),o.Fc(e.user.email),o.Ab(1),o.jc("ngIf",e.user.stripeLink),o.Ab(7),o.Bb("datetime",o.gc(21,20,e.getUserCreationTime(),"yyyy-MM-d")),o.Ab(2),o.Gc(" ",o.gc(23,23,e.getUserCreationTime()||0,"d MMMM, yyyy")," "),o.Ab(6),o.Gc(" ",o.gc(29,26,(null==e.stripeDetails?null:e.stripeDetails.spent)||0,"EUR")," "),o.Ab(5),o.Db("mt-1 text-sm sm:col-span-2 ",e.stripeDetails.statusColor,""),o.Ab(1),o.Gc(" ",e.stripeDetails.statusTranslated||"..."," "),o.Ab(5),o.Gc(" ",e.stripeDetails.subType||"..."," "),o.Ab(1),o.jc("ngIf","active"===e.stripeDetails.subStatus||"trialing"===e.stripeDetails.subStatus||e.stripeDetails.hasCanceled),o.Ab(1),o.jc("ngIf","active"===e.stripeDetails.subStatus||"trialing"===e.stripeDetails.subStatus),o.Ab(1),o.jc("ngIf",e.stripeDetails.hasCanceled),o.Ab(3),o.jc("user",e.user)("subsInfo",e.subsInfo),o.Ab(5),o.jc("href","mailto:"+e.user.email,o.xc)}}let T=(()=>{class e{constructor(e,t){this.users=e,this.cdRef=t,this.stripeDetails={spent:void 0,hasCanceled:void 0,canceledDate:void 0,subStartDate:void 0,subRecurring:void 0,subType:void 0,subStatus:void 0,statusTranslated:void 0,statusColor:void 0},this.ffn=v.a.app().functions("europe-west2"),this.getStripeUserSpent=this.ffn.httpsCallable("getStripeUserSpent"),this.$subs=[]}set setUser(e){if(!e||!e.id)return;this.user=e,this.$subs.length>0&&this.$subs.forEach(e=>{e.unsubscribe()});const t=this.users.getSubscriptionInfo(e.id).subscribe(e=>{this.subsInfo=e,this.setCurrentSub(e.subs),this.cdRef.detectChanges()});this.initUserStripeDetails(),this.$subs.push(t)}ngOnInit(){}getAvatarInfo(e){var t,s;return{img:(null===(t=e.details)||void 0===t?void 0:t.imgUrl)||"",fullName:e.name||"",email:e.email,color:(null===(s=e.details)||void 0===s?void 0:s.imgColorBg)||"indigo"}}setCurrentSub(e){var t;let s,i;e.forEach(e=>{if(e.status)return!s||s<=e.created.seconds?(s=e.created.seconds,void(i=e)):void 0});const n=null==i?void 0:i.items[0].price.id;i&&n===w.a.stripeProducts.prod.month&&(this.stripeDetails.subType="Mensile"),i&&n===w.a.stripeProducts.prod.year&&(this.stripeDetails.subType="Annuale");const r=(null==i?void 0:i.current_period_end.seconds)||0;this.stripeDetails.subStartDate=new Date(1e3*((null==i?void 0:i.current_period_start.seconds)||0)),this.stripeDetails.subRecurring=new Date(1e3*r),this.stripeDetails.hasCanceled=!!(null==i?void 0:i.canceled_at);const a=(null===(t=null==i?void 0:i.canceled_at)||void 0===t?void 0:t.seconds)||0;this.stripeDetails.canceledDate=new Date(1e3*a),this.stripeDetails.subStatus=null==i?void 0:i.status,this.translateSubStatus(null==i?void 0:i.status)}getUserCreationTime(){var e;const t=null===(e=this.user.createdAt)||void 0===e?void 0:e.seconds;if(t)return new Date(1e3*t)}translateSubStatus(e){let t,s;switch(e){case"active":t="Attivo",s="text-green-500";break;case"past_due":t="Scaduto",s="text-yellow-500";break;case"unpaid":t="Non pagato",s="text-red-500";break;case"canceled":t="Cancellato",s="text-red-500";break;case"incomplete":t="Incompleto",s="text-yellow-500";break;case"incomplete_expired":t="Cancellato",s="text-red-500";break;case"trialing":t="In prova gratuita",s="text-green-500";break;default:t="Nessun abbonamento",s="text-grey-400"}this.stripeDetails.statusTranslated=t,this.stripeDetails.statusColor=s}initUserStripeDetails(){return Object(x.a)(this,void 0,void 0,function*(){if(!this.user||!this.user.stripeId)return;const e=yield this.getStripeUserSpent(this.user.stripeId);this.stripeDetails.spent=e.data,this.cdRef.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(o.Mb(d.a),o.Mb(o.h))},e.\u0275cmp=o.Gb({type:e,selectors:[["app-admin-user-details"]],inputs:{setUser:["user","setUser"]},decls:1,vars:1,consts:[["class","h-max flex flex-col bg-black-800 shadow-xl rounded-md overflow-hidden",4,"ngIf"],[1,"h-max","flex","flex-col","bg-black-800","shadow-xl","rounded-md","overflow-hidden"],[1,"pb-1","sm:pb-6"],[1,"mt-6","px-4","sm:mt-8","sm:flex","sm:items-center","sm:px-6"],[1,"flex-1"],[1,"flex","flex-row","relative","space-x-4","items-center"],["displayType","img",3,"user","enableProfileLink"],["class","absolute top-1 left-4 rounded-full text-yellow-400 bg-gray-800 ring-4 ring-gray-800",4,"ngIf"],[1,"flex","items-center"],[1,"font-bold","text-xl","text-gray-100","sm:text-2xl"],[1,"text-sm","text-gray-400"],["target","_blank","class","cursor-pointer w-min flex-grow-0 relative group hover:ring hover:shadow-xl rounded-md",4,"ngIf"],[1,"px-4","pt-5","pb-5","sm:px-0","sm:pt-0"],[1,"grid","grid-cols-1","gap-x-4","gap-y-8","sm:grid-cols-2","px-4","sm:px-6"],[1,"sm:col-span-1"],[1,"text-sm","font-medium","text-gray-500","sm:w-40"],[1,"mt-1","text-sm","sm:col-span-2"],["class","sm:col-span-1",4,"ngIf"],[1,"text-sm","text-gray-500","mx-6","mt-8"],[1,"mt-4",3,"user","subsInfo"],[1,"mt-8","px-4","sm:px-6"],[1,"text-sm","font-medium","mb-2","text-gray-500","sm:w-40"],[1,"inline-flex","space-x-4"],["target","_blank",1,"btn","primary",3,"href"],[1,"btn","primary"],[1,"btn","danger"],[1,"absolute","top-1","left-4","rounded-full","text-yellow-400","bg-gray-800","ring-4","ring-gray-800"],["name","shieldFillCheck","width",".8rem","height",".8rem"],["target","_blank",1,"cursor-pointer","w-min","flex-grow-0","relative","group","hover:ring","hover:shadow-xl","rounded-md"],["path","assets/icons/stripe.svg","width","1.75rem","height","1.75rem"],[1,"opacity-0","group-hover:opacity-100","max-w-sm","z-10","absolute","top-9","right-0","bg-black-900","shadow-lg","rounded-md","px-4","py-2","pointer-events-none"],[1,"text-sm","text-gray-200","whitespace-nowrap"]],template:function(e,t){1&e&&o.Cc(0,G,56,29,"div",0),2&e&&o.jc("ngIf",t.user)},directives:[i.m,y.a,E,S.a,j.a],pipes:[i.f,i.d],styles:["[_nghost-%COMP%] { width: 100%; }"],changeDetection:0}),e})(),F=(()=>{class e{}return e.\u0275mod=o.Kb({type:e}),e.\u0275inj=o.Jb({factory:function(t){return new(t||e)},imports:[[i.c,g,n.p,r.a]]}),e})();o.yc(f,[S.a,n.b,n.l,n.f,i.l,i.k,y.a,i.m,T],[])},xvIq:function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s("fXoL"),n=s("e8Ap");const r=function(e,t){return{width:e,height:t,fill:"currentColor"}};let a=(()=>{class e{constructor(){this.width="1em",this.height="1em"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["app-path-svg"]],inputs:{path:"path",width:"width",height:"height"},decls:1,vars:5,consts:[[1,"flex-1","w-max",3,"inlineSVG","setSVGAttributes"]],template:function(e,t){1&e&&i.Nb(0,"div",0),2&e&&i.jc("inlineSVG",t.path)("setSVGAttributes",i.mc(2,r,t.width,t.height))},directives:[n.a],styles:["[_nghost-%COMP%] { @apply flex justify-center items-center; }"],changeDetection:0}),e})()}}]);